<style>

/* reset */
html{color:#666;background:#fff;}body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,textarea,p,blockquote,th,td{margin:0;padding:0;}table{border-collapse:collapse;border-spacing:0;}fieldset,img{border:0;}address,caption,cite,code,dfn,em,strong,th,var{font-style:normal;font-weight:normal;}li{list-style:none;}caption,th{text-align:left;}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}q:before,q:after{content:'';}abbr,acronym{border:0;font-variant:normal;}sup{vertical-align:text-top;}sub{vertical-align:text-bottom;}input,textarea,select{font-family:inherit;font-size:inherit;font-weight:inherit;}input,textarea,select{*font-size:100%;}legend{color:#000;}
body{font:13px/1.231 "Trebuchet MS", Trebuchet, Arial, sans-serif;}select,input,button,textarea{font:99% "Trebuchet MS", Trebuchet, Arial, sans-serif;}table{font-size:inherit;font:100%;}pre,code,kbd,samp,tt{font-family:monospace;*font-size:108%;line-height:100%;}
/* ====== template ====== */
html{background:#fff;}
body{_text-align:center;}
.txcen{text-align:center}
.colorwhite{color:#FFF;}
.body,.main{*zoom:1;}
.body{background-color:#fff;}
.capa{background:#FFF url(http://imgs.dev.alterosa.com.br/bg_padrao.jpg) no-repeat;}
.body:after,.line:after,.lastUnit:after,.inner:after,.hd:after,.bd:after,.ft:after{clear:both;display:block;visibility:hidden;overflow:hidden;height:0 !important;line-height:0;font-size:xx-large;content:" x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x ";}
.page{margin:0 auto;width:990px;_text-align:left;}
.liquid{width:auto;margin:0;}
.main{float:left;width:650px;_margin-right:-3px;}
.rightCol{float:right;width:340px;_margin-left:-3px;}
.gs990{width:990px;}
.center {margin:0 auto;}
.w130{width:125px;}
.w315{width:315px;}
.mh40{min-height:40px}
.servicos li{display:inline; margin:0 15px 0 0;}
.servicos span{margin:0 0 10px 0;}
.bdr2w{border-right:1px solid #fff;}
.bdr2w:last-child{border-right:none;}
.bdrbt{border-bottom:1px solid #ccc;}
.bdr3bt{border-bottom:3px solid #ccc;}
.mntl{position:absolute;width:315px;margin-top:155px;}
.pr{position:relative;}
.dsint{height:224px;overflow:hidden;}
.dtable{display:table;}
.h190{height:190px;}
/* ====== grid ====== */
.line{*zoom:1;}
.unit{float:left;}
.flri{float:right;}
.txri{text-align:right;}
.size1of1{float:none;}
.size1of2{width:50%;}
.size1of3{width:33.33333%;}
.size2of3{width:66.66666%;}
.size1of4{width:25%;}
.size3of4{width:75%;}
.size1of5{width:20%;}
.size2of5{width:40%;}
.size3of5{width:60%;}
.size4of5{width:80%;}
.size1of7{width:14.28571428571429%;}
.size5of7{width:71.42857142857145%;}
.lastUnit{display:table-cell;float:none;width:auto;*display:block;*zoom:1;_position:relative;_left:-3px;_margin-right:-3px;}
.lastUnit2{float:none;width:auto;*display:block;*zoom:1;_position:relative;_left:-3px;_margin-right:-3px;}
.lastUnit3{float:left;margin:0;*zoom:1;_left:-3px;_margin-right:-3px;}
/* ====== media ====== */
.media{margin:10px 0;}
.media .bd{display:table-cell; zoom:1;}
.media .bd > :first-child{margin-top:0;}
.media .bd > :last-child{margin-bottom:0;}
.media .img{float:left;margin:0 10px 0 10px;}
.media .img img{display:block;}
.media .imgExt{float:right;margin:0 10px;}
.mod{margin:10px 10px 10px 0;}
.inner,.bd,.ft{*zoom:1;}
.inner{position:relative;}
/* ====== espacos ====== */
 blockquote{margin-left:10px;}
h2, h3, h4, img{padding-bottom:0px;}
p {margin-bottom:10px;}
.line p {margin-bottom:20px;}
.line h2, .line h3, .line h4 {margin-bottom:0px;}
.line ul{padding:0 0 20px;}
.ptn,.pvn,.pan{padding-top:0px}
.pts,.pvs,.pas{padding-top:5px}
.ptm,.pvm,.pam{padding-top:10px}
.ptl,.pvl,.pal{padding-top:20px}
.prn,.phn,.pan{padding-right:0px}
.prs,.phs,.pas{padding-right:5px}
.prm,.phm,.pam{padding-right:10px}
.prl,.phl,.pal{padding-right:20px}
.pbn,.pvn,.pan{padding-bottom:0px}  
.pbs,.pvs,.pas{padding-bottom:5px}
.pbm,.pvm,.pam{padding-bottom:10px}
.pbl,.pvl,.pal{padding-bottom:20px}
.pln,.phn,.pan{padding-left:0px}
.pls,.phs,.pas{padding-left:5px}
.plm,.phm,.pam{padding-left:10px}
.pll,.phl,.pal{padding-left:20px}
.mtn,.mvn,.man{margin-top:0px}
.mts,.mvs,.mas{margin-top:5px}
.mtm,.mvm,.mam{margin-top:10px}
.mtl,.mvl,.mal{margin-top:20px}
.mrn,.mhn,.man{margin-right:0px}
.mrs,.mhs,.mas{margin-right:5px}
.mrm,.mhm,.mam{margin-right:10px}
.mrl,.mhl,.mal{margin-right:20px}
.mbn,.mvn,.man{margin-bottom:0px}  
.mbs,.mvs,.mas{margin-bottom:5px}
.mbm,.mvm,.mam{margin-bottom:10px}
.mbl,.mvl,.mal{margin-bottom:20px}
.mln,.mhn,.man{margin-left:0px}
.mls,.mhs,.mas{margin-left:5px}
.mlm,.mhm,.mam{margin-left:10px}
.mll,.mhl,.mal{margin-left:20px}
/* ====== alinhamento ======= */
.tal{text-align:left;}
.tac{text-align:center;}
.tar{text-align:right;}
.m0auto{margin:0 auto;}
/* ====== links ======= */
a{text-decoration:none; }
a:focus,a:hover {text-decoration:underline;}
a {color:#D75D00;}
h1 a{color:#333;}
h2 a{color:#900;}
h2 a:hover{color:#D75D00;text-decoration:none;}
h3 a{color:#990000;}
.dsint a {color:#fff;}
.dssec p a, .dzai p a, .bpv p a, .ncat a, .media p a {color:#666;}
.ncat .checked {background:#99abb5;color:#fff;}
.ncat div:hover {background:#c7c7c7;color:#666;}
.lista a{color:#666;}
/* ====== fonts ====== */
h1{font-size:25px;color:#333;font-weight:800;}
h2{color:#900;font-size:16px;font-weight:800;}
h3{color:#900;font-size:14px;}
h4{color:#D75D00;}
.dzai h2{color:#fff;}
.videos p{margin:0;}
/* ====== borda img ====== */
a.innerborder, a.innerborder img {float:left;overflow:hidden;}
a.innerborder:hover {border:3px solid #ff9900;}
a.innerborder:hover img {margin:-3px;}
/* ====== bordas ====== */
.brads{-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;}
.bradm{-moz-border-radius:6px;-webkit-border-radius:6px;border-radius:6px;}
.bradl{-moz-border-radius:10px;-webkit-border-radius:10px;border-radius:10px;}
.bsols{border:1px solid;}
.bsolm{border:3px solid;}
.bsoll{border:6px solid;}
.bcr{border-color:#790101;}/*border color red*/
.bclg{border-color:#CCC;}/*border color light grey*/
.bcw{border-color:#FFF; cursor:pointer}/*border color white*/
/* ========= Elementos ========= */
.rotacional p, .rotacional h3{margin:0 0 0 10px;}
.rotacional li{font-size:14px;}
.rotacional a{color:#666;}
div#feature_list {height: 259px;overflow: hidden;position: relative;width: 639px;}
#feature_list li a.current{background:#d1d0d0;z-indez:999;position: relative;display:block;}
#feature_list li a.current:after {content: "";position: absolute;left: -12px;top:0;border-right: 12px solid #B60002;border-top: 12px solid transparent;border-bottom: 12px solid transparent;}
#feature_list .tabs li a {padding:9px 0;display:block;}
#feature_list .output{float:left;width:393px;}
#feature_list .tabs{width:246px;margin-left:393px;}
#feature_list .tabs li a:hover{background:#dfdfdf;}
.destaque a{color:#666;}
.destaque h2 a{color:#900;}
.destaque h2 a:hover{color:#D75D00;text-decoration:none;}
.destaque h2, .destaque p{margin-left:0px;}
.programacao p, .programacao h3{margin:0 0 0 10px;}
.programacao a p{color:#666;}
.ultimas li {margin:15px 0;}
.ultimas .lista li {margin:0;padding:10px;}
.ultimas li:hover {background:#ebece4;}
.ultimas li span{margin:0 10px 0 0;color:#900;}
.ultimas li.dia{padding:5px;color:#fff;background:#d75d00;font-weight:800;}
.navegacao li{display:inline;}
.navegacao .pg li{padding:5px;}
.navegacao div{padding:0 3px;color:#d75d00;line-height:20px;}
.navegacao span{margin:0 4px;}
.navegacao .pg li:hover{background:#CCC;}
/*========== menu ===============*/
ul.menu {background:#b60002;height:42px!important;position:relative;padding:0!important;}
.menu_sup li{display:inline; margin:0 5px 0 0;}
.menu a{font-size:16px;border-right:1px solid #900;line-height:42px;padding:10px;color:#fff;}
.menu_sup a {color:#fff;text-decoration:none;font-size:12px;}
.menu .checked {background:#fff;filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#ffffff',GradientType=0 );color:#900!important;}
.menu .mhover, .menu li a:hover {background:#8E0000;filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#ffffff',GradientType=0 );color:#fff!important;text-decoration:none;}
.submenu1{position:absolute;background:#eee;width:990px;color:#000;height:0;margin:0 0 0 -61px;overflow:hidden;}
.submenu1 li{display:inline;}
.submenu1 li a{display:inline;font-size:13px;color:#666;font-weight:800;float:left;border-right:none!important;padding:0 10px;}
.submenu1 li a:hover, .submenu1 li.mhover{color:#900;background:#99abb5;}
.submenu2{position:absolute;background:#99abb5;width:990px;color:#fff;height:42px;margin:40px 0 0 0;}
.submenu2 li{display:inline;}
.submenu2 li a{display:inline;font-size:13px;color:#fff;font-weight:800;float:left;border-right:none!important;padding:0 10px;}
.submenu2 li a:hover {color:#900;background:99abb5;}
/*========== form ===============*/
input{border:1px solid #c7c7c7;color:#666;}
.direita .ultimas input{width:90px;}
select{color:#666;}
.busca{height:18px;}
/*========== backgrounds e colors ===============*/
.bdc{border-bottom:1px solid #ccc;background: #dddedd; /* Old browsers */background: -moz-linear-gradient(top, #f4f5f5 12%, #dddedd 63%); /* FF3.6+ */background: -webkit-gradient(linear, left top, left bottom, color-stop(12%,#f4f5f5), color-stop(63%,#dddedd)); /* Chrome,Safari4+ */background: -webkit-linear-gradient(top, #f4f5f5 12%,#dddedd 63%); /* Chrome10+,Safari5.1+ */background: -o-linear-gradient(top, #f4f5f5 12%,#dddedd 63%); /* Opera11.10+ */background: -ms-linear-gradient(top, #f4f5f5 12%,#dddedd 63%); /* IE10+ */filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f4f5f5', endColorstr='#dddedd',GradientType=0 ); /* IE6-9 */background: linear-gradient(top, #f4f5f5 12%,#dddedd 63%); /* W3C */}
.bgvc{background: #C73000; color:#fff; /* Old browsers */background: -moz-linear-gradient(top, #d85f00 31%, #b60002 100%); /* FF3.6+ */background: -webkit-gradient(linear, left top, left bottom, color-stop(31%,#d85f00), color-stop(100%,#b60002)); /* Chrome,Safari4+ */background: -webkit-linear-gradient(top, #d85f00 31%,#b60002 100%); /* Chrome10+,Safari5.1+ */background: -o-linear-gradient(top, #d85f00 31%,#b60002 100%); /* Opera11.10+ */background: -ms-linear-gradient(top, #d85f00 31%,#b60002 100%); /* IE10+ */filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#d85f00', endColorstr='#b60002',GradientType=0 ); /* IE6-9 */background: linear-gradient(top, #d85f00 31%,#b60002 100%); /* W3C */border-top:2px solid #cccccc;}
.bbc{border-bottom:1px solid #ccc;}
.bfv{background:#900;}
.bgv{background: #790101; /* Old browsers */background: -moz-linear-gradient(top, #943532 48%, #790101 49%); /* FF3.6+ */background: -webkit-gradient(linear, left top, left bottom, color-stop(48%,#943532), color-stop(49%,#790101)); /* Chrome,Safari4+ */background: -webkit-linear-gradient(top, #943532 48%,#790101 49%); /* Chrome10+,Safari5.1+ */background: -o-linear-gradient(top, #943532 48%,#790101 49%); /* Opera11.10+ */background: -ms-linear-gradient(top, #943532 48%,#790101 49%); /* IE10+ */filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#943532', endColorstr='#790101',GradientType=0 ); /* IE6-9 */background: linear-gradient(top, #943532 48%,#790101 49%); /* W3C */}
.bgv2{background-color:#B60002;}
.bglg{background: #ffffff;background: -moz-linear-gradient(top, #ffffff 0%, #e3e4e6 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e3e4e6));background: -webkit-linear-gradient(top, #ffffff 0%,#e3e4e6 100%);background: -o-linear-gradient(top, #ffffff 0%,#e3e4e6 100%);background: -ms-linear-gradient(top, #ffffff 0%,#e3e4e6 100%);background: linear-gradient(top, #ffffff 0%,#e3e4e6 100%);filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#e3e4e6',GradientType=0 );}
.bve{background: #790101;}
.bce{background:#99abb5;}
.bcc{background:#eee;}
.bmc{background:#ebece4;}
.bme{background:#d5d7c6;}
.bp{background:#53524c;}
.bgg{background:#CCC;}
.bglo{background:#ebece4;}
.ccc{color:#999!important;}
.cce{color:#333!important;}
.ccv{color:#900!important;}
.ccb{color:#fff!important;}
.ccl{color:#d75d00!important;}
.ccw{color:#FFF!important;}
/*==============listas ==================*/
.lird a{color:#fff; font-weight:bold;}
.lird li {display:inline;}
/*========== ICONES ===============*/
.i_videoM, .i_fotoM, .i_noticiaM, .i_alterosa, .i_alterosaM, .i_dzai, .i_cinema, .i_financeiro, .i_vrum, .i_guia, .i_clima, .i_promocoes, .i_eventos, .i_chacras, .i_transito, .i_guarani, .i_forum, .i_enquete, .i_forums, .i_data, .i_nini, .i_niniA, .i_nfim, .i_nfimA, .i_nprox, .i_nproxA, .i_nant, .i_nantA, .i_enquetes, .i_comentario, .i_avaliacao, .i_diminui, .i_aumenta, .i_imprimir, .i_enviar, .i_corrigir{background:url(http://imgs.dev.alterosa.com.br/icones.png) no-repeat 0 0;display:inline-block;}
.i_videoM{background-position:0 0;width:126px;height:30px;}
.i_fotoM{background-position:0 -35px;width:126px;height:30px;}
.i_noticiaM{background-position:0 -72px;width:126px;height:30px;}
.i_alterosa{background-position:0 -141px;width:22px;height:25px;}
.i_alterosaM{background-position:0 -105px;width:30px;height:35px;}
.i_dzai{background-position:0 -166px;width:40px;height:22px;}
.i_cinema{background-position:0 -200px;width:65px;height:57px;}
.i_financeiro{background-position:0 -259px;width:65px;height:57px;}
.i_vrum{background-position:0 -318px;width:65px;height:57px;}
.i_guia{background-position:0 -377px;width:65px;height:57px;}
.i_clima{background-position:0 -436px;width:65px;height:57px;}
.i_promocoes{background-position:0 -495px;width:65px;height:57px;}
.i_eventos{background-position:0 -554px;width:65px;height:57px;}
.i_chacras{background-position:0 -613px;width:65px;height:57px;}
.i_transito{background-position:0 -672px;width:65px;height:57px;}
.i_guarani{background-position:0 -731px;width:65px;height:57px;}
.i_forum{background-position:0 -791px;width:45px;height:47px;}
.i_enquete{background-position:0 -837px;width:47px;height:47px;}	 
.i_forums{background-position:0 -883px;width:32px;height:27px;}
.i_enquetes{background-position:0 -919px;width:32px;height:27px;}
.i_data{background-position:0 -952px;width:16px;height:16px;}
.i_nini{background-position:0 -971px;width:13px;height:11px;}
.i_niniA{background-position:-14px -971px;width:13px;height:11px;}
.i_nant{background-position:0 -987px;width:13px;height:11px;}
.i_nantA{background-position:-14px -987px;width:13px;height:11px;}
.i_nfim{background-position:0 -1001px;width:13px;height:11px;}
.i_nfimA{background-position:-14px -1001px;width:13px;height:11px;}
.i_nprox{background-position:0 -1018px;width:13px;height:11px;}
.i_nproxA{background-position:-14px -1018px;width:13px;height:11px;}
.i_comentario{background-position:0 -1033px;width:17px;height:16px;}
.i_avaliacao{background-position:0 -1050px;width:12px;height:12px;}
.i_diminui{background-position:0 -1067px;width:20px;height:14px;}
.i_aumenta{background-position:0 -1085px;width:20px;height:14px;}
.i_imprimir{background-position:0 -1101px;width:17px;height:16px;}
.i_enviar{background-position:0 -1120px;width:17px;height:16px;}
.i_corrigir{background-position:0 -1139px;width:17px;height:16px;}
/* ============= Comentarios ===================*/
.socialbox {padding:5px;margin:10px 0;background-color:#f6f5ed; clear:both;height:240px}
.socialbox .h3 {color:#efb31e;}
.socialbox .zebra {background-color:#fff;}
.socialbox textarea {width:250px;height:70px;background-color:#d9e1e4;}
.socialbox .comments {width:350px;height:243px;margin:-1px;float:right;overflow:hidden;}
.socialbox .comments div {width:350px;height:259px;overflow:scroll;}
.comment_loggin {height:213px;}
.comment_loggin label {display:block;}
.comment_loggin .btn {background:url(http://imgs.dev.alterosa.com.br/send_comment.gif) center;}
/* Compartilhe AddTHis | 30-05-2011 */
.share{ width:100%; background:#FCFCFC; padding:5px 0; margin: 10px 0;float: left;border: 1px solid #C0CEDB;}
.share_tit{ background:#dd8746; font-size:15px; font-weight:700; font-family:'trebuchet ms', arial, verdana; color:#fff; margin:0 5px 5px; padding:5px;}
.addthis_button_compact {margin:0 0 0 10px;}
.share a{margin: 0 30px 0 5px !important;color:#4C7EB1;}
.addthis_button_compact {margin:0 0 0 5px!important; border-left:1px solid #4C7EB1!important;}
.addthis_toolbox {margin: 0 2px;} 
/* ============= Calendario ===================*/
.calendario ul{padding-bottom:1px;}
.calendario ul li{height:27px;}
.calendario ul li div{height:15px;}
/*caixa de instrucoes*/

.cabecalho_calendario input {
  margin-left:30px;

}

.cabecalho_calendario{
  position:absolute;
  left:210px;
  top:40px
}

div.instrucao {
    background: url("/imgs/ic_erro.gif") no-repeat scroll 10px top #F9F7F7;
    border: 1px solid #D5B7B7;
    width:200px;
    margin: 12px 0 10px;
    padding: 8px 8px 8px 30px;
}

div.detalhes_copiar {
    background: url("/imgs/ic_erro.gif") no-repeat scroll 10px top #98FB98;
    width:200px;
    border: 1px solid #D5B7B7;
    margin: 12px 0 10px;
    padding: 8px 8px 8px 30px;
}


</style>

<tal:block tal:define="macro python:here.macros('/app/macroform.env'); 
                             req here/request;
                             id_site req/id_site;
                             id_treeapp python:req.get('id_treeapp', '');
                             id_aplicativo req/id_aplicativo;
                             id_content req/id_content;
                             id_conteudo req/id_conteudo;
                             schema req/schema;
                             meta_type req/meta_type;
                             portal here/portal;
                             util here/util;
                             file here/file;
                             instance python:here.app(schema=schema);
                             date python:instance._getdate();
                             n python:instance._getConteudo(id_conteudo);
                             datahoje python:util.dtnow('%d/%m/%Y %H:%M');
                             dados python:portal._getDadosTreeApp(env_site=id_site, id_treeapp=id_treeapp);
                             configuracao dados/configuracao;
                             publicacao dados/publicacao;
                             exportar_json python:publicacao.get('exportar_json', '');
                             exportar_xml python:publicacao.get('exportar_xml', '');
                             ">
<metal_macro metal:use-macro="macro/macros/form">

<slot_script metal:fill-slot="javascripts">
    <script type="text/javascript" src="/extensao/js/environ_relacionamento.js"></script>
    <script type="text/javascript" src="/extensao/js/environ_destaque.js"></script>
    <script type="text/javascript" tal:content="structure python:util.py2js(ID_SITE=id_site,
                                                                            SCHEMA=schema,
                                                                            BASEMETHOD=portal._getUrlAppMethod(meta_type=instance.meta_type, schema=schema, id_site=id_site),
                                                                            ID_TREEAPP=id_treeapp,
                                                                            DATAHOJE=datahoje,
                                                                            ID_APLICATIVO=id_aplicativo,
                                                                            ID_CONTEUDO=id_conteudo,
                                                                            EXPORTAR_JSON=exportar_json,
                                                                            EXPORTAR_XML=exportar_xml)"></script>
    <script type="text/javascript" tal:content="structure python:util.py2js(TITULO_DESTAQUE=configuracao.get('titulo_destaque', None),
                                                                            DESCRICAO_DESTAQUE=configuracao.get('descricao_destaque', None),
                                                                            IMAGEM_DESTAQUE=configuracao.get('imagem_destaque', None),
                                                                            TAGS=configuracao.get('tags_verify', 'livre'),
                                                                            IDS_CAMPOS=configuracao.get('ids_campos', []))"></script>
        <script type="text/javascript">
    var _semana = false;
    var _dia = true ;
    var _mes = false;
    var _historico_origen = new Array();
    var _historico_destino = new Array();
    var _origen = true;
    var _destino = false;
    var IFRAMEUSE = false;
    var URLORIGEN = "";
    var URLDESTINO = "";
    var URLDATA = "clonardata?id_aplicativo="+ID_APLICATIVO+"&id_treeapp="+ID_TREEAPP;
    var abas = ['geral', 'destaque', 'copiarprogramacao'];

    $(document).ready(function()
    {
      var form = document.forms['conteudo']; 

    $('.seta_direita').click(function(){
        getNextDate();
        selecionar_datas_historico(_origen);
    });
    
    $('.seta_esquerda').click(function(){
        getPrevioustDate();
        selecionar_datas_historico(_origen);
    });

    $('.copiar').click(function(){
      var copiar_de = $('.descricao_copia li').length
      var copiar_para = $('.detalhes_copiar li').length

      if((copiar_de != copiar_para) && !(copiar_de > 20 && copiar_para>20 ))
      {
        alert("As op&ccedil;&otilde;es de copia devem ser iguais")
        return
      }

      if(URLORIGEN == "")
      {
        alert("Selecione a data que sera copiada");
        return
      }

      if(URLDESTINO == "")
      {
        alert("Selecione a data para onde iram ser copiadas");
        return
      }

      $.post(BASEMETHOD + URLDATA + URLORIGEN + URLDESTINO,function(data) {
         data = JSON.parse(data);
         if(data.ok)
         {
           alert("Datas copiadas com sucesso.");
           abrirF5Listagem('/app/listarcontent.env?edicao=1&id_site=' + ID_SITE + '&id_treeapp=' + ID_TREEAPP);
         }    

      });
       });
});




    function validaForm(exportar)
    {
        var form = document.forms['conteudo'];
        var errs = [];
        with (form)
        {
            if (isEmpty(titulo.value))
                errs.push('O campo t&iacute;tulo &eacute; obrigat&oacute;rio.');
            if (isEmpty(publicado_em.value))
                errs.push('O campo publicado em &eacute; obrigat&oacute;rio.');
            if (isEmpty(data.value))
                errs.push('O campo data &eacute; obrigat&oacute;rio.');


            envpermissao.erros(errs);
            if (errs.length > 0)
            {
                showError(errs);

            } else {
                aguarde(false);
                var dados = {};

                if (exportar)
                    dados['exportar'] = 1;
                dados['exportar_json'] = EXPORTAR_JSON;
                dados['exportar_xml'] = EXPORTAR_XML;

                dados['id_site'] = ID_SITE;
                dados['id_treeapp'] = ID_TREEAPP;
                dados['id_aplicativo'] = ID_APLICATIVO;
                dados['id_conteudo'] = id_conteudo.value;

                dados['titulo'] = titulo.value.replace('+', '%2b', 'g');
                dados['descricao'] = descricao.value;
                dados['publicado_em'] = publicado_em.value;
                dados['data'] = data.value;
                if (publicado[0].checked == true)
                    dados['publicado'] = 1;
                //destaque
                destaque.add(dados);

                //tags
                dados['tags'] = tags.value;

                //relacionamento
                relacionamento.addRelacionamento(dados);

                //permissoes
                envpermissao.add(dados);



                $.ajax({
                  type: "POST",
                  url: BASEMETHOD + "editConteudo",
                  data: dados,
                  beforeSend: function(x) {
                    if(x && x.overrideMimeType) {
                      x.overrideMimeType("application/j-son;charset=UTF-8");
                    }
                  },
                  dataType: "json",
                  success: function(res){
                     if (res['ok'])
                     {
                       showOk(res['ok']);
                       abrirF5Listagem('/app/listarcontent.env?edicao=1&id_site=' + ID_SITE + '&id_treeapp=' + ID_TREEAPP);
                       verdata();
                     } else {
                       showError([res['error']]);
                     }
                     aguarde(true);
                  },
                  error: function(XMLHttpRequest, textStatus, errorThrown) { 
                  }
                });
            }
        }
    }



   function clean_calendar()
    {
       for (var i=6; i>0; --i) 
       {
         var semana = $('.semana'+i);
         $(semana).css('background','');
       }
    }

    function link_dia(data,semana,tag){
       clean_calendar()

       if($('#a_aba_geral').hasClass('tab3'))
       { 
         $('.data_spam').text(data);
         $('.titulo_spam').text(data.substr(0,2) + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear());
         document.getElementById('data').value = data;
         document.getElementById('titulo').value = data.substr(0,2) + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear();
       }
       else
       {
       if(_origen){
          _historico_origen.length = 0;
          URLORIGEN = "";
       }
       if(_destino){
         _historico_destino.length = 0
         URLDESTINO = "";
         console.log(URLDESTINO);
       }
         var detalhes = "";
         if(_semana)
         {
           var class_semana = $('.'+semana);
           if(_origen)
           {
             _historico_origen[0] = {'semana':'.'+semana, 'mes':String($(tag).parent().eq(0).attr('data-name'))};
             class_semana.map(function(){
                var dia = String($(this).children().eq(0).text());
                if(dia.length=="1")
                {
                  dia = '0'+dia
                }
                detalhes += '<li>'+ dia + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear()+'</li>';
                URLORIGEN +='&data_txt=' + dia + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear();
                URLORIGEN += '&data_de=' + String($(this).attr('data-data'));
             })
             $(class_semana).css('background','#FF0000');
           }
           if(_destino)
           {
             _historico_destino[0] = {'semana':'.'+semana, 'mes':String($(tag).parent().eq(0).attr('data-name'))};
              class_semana.map(function(){
                var dia = String($(this).children().eq(0).text());
                if(dia.length=="1")
                {
                  dia = '0'+dia
                }
                 detalhes += '<li>'+ dia + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear()+'</li>';
                 URLDESTINO +='&data_para_txt=' + dia + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear();
                 URLDESTINO += '&data_para=' + String($(this).attr('data-data'));
             })
             $(class_semana).css('background','#98FB98');  
           }

         }
         if(_mes)
         {
           var x = 0;
           for (var i=6; i>0; --i) 
           {
             if(_origen)
             {
               var semana = $('.semana'+i)
               $(semana).css('background','#FF0000')
               _historico_origen[x] = {'semana':'.semana'+i, 'mes':String($(tag).parent().eq(0).attr('data-name'))};
             }
             if(_destino)
             {
               var semana = $('.semana'+i)
               $(semana).css('background','#98FB98');
               _historico_destino[x] = {'semana':'.semana'+i, 'mes':String($(tag).parent().eq(0).attr('data-name'))};
             }
             x= x + 1;

              semana.map(function(){
               var dia = String($(this).children().eq(0).text())
               if(dia.length == 1)
               {
                 dia = '0' + dia;
               }
               if(!(String($(this).children().eq(0).text())==""))
               {
                 detalhes += '<li>'+ dia + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear()+'</li>';
                 if(_origen)
                 {
                     URLORIGEN +='&data_txt=' + dia+ ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear();
                     URLORIGEN += '&data_de=' + String($(this).attr('data-data'));
                 }

                 if(_destino)
                 {
                 
                    URLDESTINO +='&data_para_txt=' + dia + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear();
                    URLDESTINO += '&data_para=' + String($(this).attr('data-data'));
                 }
               }
             })
           }
         }
         if(_dia)
         {
           detalhes += '<li>' + data.substr(0,2) + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear() + '</li>';
           if(_origen){
             $(tag).parent().eq(0).css('background','#FF0000')
             _historico_origen[0] = {'semana':$(tag).parent().eq(0), 'mes':String($(tag).parent().eq(0).attr('data-name'))};
                    URLORIGEN +='&data_txt=' + data.substr(0,2) + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear();
                    URLORIGEN += '&data_de=' + String($(tag).parent().eq(0).attr('data-data'));
           }
           if(_destino){
             $(tag).parent().eq(0).css('background','#98FB98');
             _historico_destino[0] = $(tag).parent().eq(0);
             _historico_destino[0] = {'semana':$(tag).parent().eq(0), 'mes':String($(tag).parent().eq(0).attr('data-name'))};
                    URLDESTINO +='&data_para_txt=' + data.substr(0,2) + ' de ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear();
                    URLDESTINO += '&data_para=' + String($(tag).parent().eq(0).attr('data-data'));
           }
         }
         if(_origen){ $('.descricao_copia').html(detalhes); }
         if(_destino){ $('.descricao_copia_geradas').html(detalhes); }
       }
    };

    function selecionar_datas_historico(tipo)
    {
       var mes_atual = String(objCalendar.actualDate.getMonth()+1)

       if(tipo)
       {
          for(i=0; i < _historico_origen.length; i++)
          {
            if(mes_atual == _historico_origen[i].mes){
            $(_historico_origen[i].semana).css('background','#FF0000');}
          }
       }
       else
       {
          for(i=0; i < _historico_destino.length; i++)
          {
            if(mes_atual == _historico_destino[i].mes){
            $(_historico_destino[i].semana).css('background','#98FB98');}
          }
        
       }
    };

$(document).ready(function(){
    $('.bto').click(function(){

     for (var i=6; i>0; --i) 
       {
         var _semana = $('.semana'+i)
         $(_semana).css('background','')
       }

     var id = this.id;
     var nome_aba = '#div_aba_' + id.substring(6);
     $('.divs').hide();
     $('.bto').removeClass('tab3')
     $('.bto').removeClass('tab2')
     $('.bto').addClass('tab2')
     $('#'+id).addClass('tab3')
     $(nome_aba).show();
     $('#bt_salvar').show();
     $('#bt_salvarp').show();
     if(id == "a_aba_copiarprogramacao")
     {
       $('.cabecalho_calendario').show();
        $('#bt_salvar').hide();
        $('#bt_salvarp').hide();
     }
     else
     {
       $('.cabecalho_calendario').hide();
     }
    });

   $('.cabecalho input').click(function(){
        var opcao = this.value;
        _semana = false
        _dia = false
        _mes = false
        clean_calendar()

        switch(opcao)
        {
        case "mes":
             _mes = true;
             break;
        case "dia":
             _dia = true;
             break;
        case "semana":
             _semana = true;
             break;
        }

   });

   $('.cabecalho_calendario input').click(function(){
        var opcao = this.value;
        _origen = false
        _destino = false
        clean_calendar()

        switch(opcao)
        {
        case "origen":
             _origen = true;
             selecionar_datas_historico(_origen);
             $('.bgv2').css('background-color','#B60002');
             break;
        case "destino":
             _destino = true;
             selecionar_datas_historico(_origen);
            $('.bgv2').css('background-color','#32CD32');
             break;
        }

   });

});


    function aguarde(w)
    {
        var bts = document.getElementById('bt_salvar')
        var btp= document.getElementById('bt_salvarp')
        if (w)
        {
           bts.value = 'Salvar';
           bts.disabled = false;
           bts.onclick = function(){validaForm(false)};
           if (btp)
           {
             btp.value = 'Salvar/Publicar';
             btp.disabled = false;
             btp.onclick = function(){validaForm(true)};
           }
        } else {
           bts.value = 'Aguarde...';
           bts.disabled = true;
           bts.onclick = function(){alert('Aguarde, processo em andamento...')};
           if (btp)
           {
             btp.value = 'Aguarde...';
             btp.disabled = true;
             btp.onclick = function(){alert('Aguarde, processo em andamento...')};
           }
        }
    }
    </script>


</slot_script>

<slot_titulo metal:fill-slot="titulo">Editar conte&uacute;do</slot_titulo>
<slot_ajuda metal:fill-slot="ajuda">Texto ajuda<br/></slot_ajuda>

<slot_content metal:fill-slot="content">

  <tal:block tal:define="macro python:here.macros('/app/macroiframe.env');">
    <tal:block metal:use-macro="macro/macros/edicao" />
  </tal:block>

  <div class="abas">
    <a id="a_aba_geral" href="javascript:mudarAba('geral');ocultarDivs();" class="tab3">Geral</a> |
  </div>
<script type="text/javascript">var tv_dates = {};</script>
 <div class="cabecalho_calendario" style="display:none;">
             <input type="radio" name="cal" checked="true" value="origen" /> Calendario Origen
             <input type="radio" name="cal" value="destino" />Calendario Destino 
 </div> 
 <div class="calendario">
 <br/>
 <ul class="line">
  <li class="unit size1of7 bgv2 colorwhite"><div class="pvs tac bsols bcw seta_esquerda"><</div></li>
  <li class="unit size5of7 bgv2 colorwhite"><div class="pvs tac bsols bcw" id="nameMonth">Programação: maio de 2012</div></li>
  <li class="unit size1of7 bgv2 colorwhite"><div class="pvs tac bsols bcw seta_direita">></div></li>
 </ul>
 <ul class="line mbm">
  <li class="unit size1of7 bgg colorwhite"><div class="pvs tac bsols bcw">dom</div><ul></ul></li>
  <li class="unit size1of7 bgg colorwhite"><div class="pvs tac bsols bcw">seg</div></li>
  <li class="unit size1of7 bgg colorwhite"><div class="pvs tac bsols bcw">ter</div></li>
  <li class="unit size1of7 bgg colorwhite"><div class="pvs tac bsols bcw">qua</div></li>
  <li class="unit size1of7 bgg colorwhite"><div class="pvs tac bsols bcw">qui</div></li>
  <li class="unit size1of7 bgg colorwhite"><div class="pvs tac bsols bcw">sex</div></li>
  <li class="unit size1of7 bgg colorwhite"><div class="pvs tac bsols">sab</div></li>
  <div class="dias"></div>
 </ul>
</div>


<script type="text/javascript" 
                               tal:content="structure python:util.py2js(tv_day=date[0],
                                                                         tv_month=int(date[1])-1,
                                                                         tv_year=date[2])"></script>
<script type="text/javascript">
var objCalendar = new Object();
objCalendar.daysInMonth = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
objCalendar.allMonth = new Array('Janeiro', 'Fevereiro', 'Marco', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro');
objCalendar.actualDayClass = 'today';
objCalendar.serverDate = new Date();
objCalendar.serverDate.setYear(tv_year);
objCalendar.serverDate.setMonth(tv_month);
objCalendar.serverDate.setDate(tv_day);
objCalendar.actualDate = new Date();
objCalendar.actualDate.setYear(tv_year);
objCalendar.actualDate.setMonth(tv_month);
objCalendar.actualDate.setDate(tv_day);
function getNextDate()
{
  var date = objCalendar.actualDate;
  var ndate = new Date();
  var month = date.getMonth();
  var year = date.getFullYear();
  ndate.setDate(1);
  
  if (month <= 10) 
  {
      ndate.setYear(year);
      ndate.setMonth(++month);
  } else {
      ndate.setYear(++year);
      ndate.setMonth(0);
  }
  objCalendar.actualDate = ndate;
  reloadCalendar();
  verdata();
}
function getPrevioustDate()
{
  var date = objCalendar.actualDate;
  var ndate = new Date();
  var month = date.getMonth();
  var year = date.getFullYear();
  ndate.setDate(1);
  
  if (month >= 1) 
  {
    ndate.setYear(year);
    ndate.setMonth(--month);
  } else {
    ndate.setYear(--year);
    ndate.setMonth(11);
  }
  objCalendar.actualDate = ndate;
  reloadCalendar();
  verdata();
}
function getMonthDays(date)
{
  var year = date.getFullYear();
  var month = date.getMonth();
  return 32 - new Date(year, month, 32).getDate();
  if (((0 == (year%4)) && ( (0 != (year%100)) || (0 == (year%400)))) == 0)
      return 29;
  else
      return objCalendar.daysInMonth[month];
}
function firstDayWeek(date)
{
  var tdate = new Date(date);
  tdate.setDate(1);
  return tdate.getDay();
}
function format_data(dia, mes, ano)
{
  var dia_ = dia;
  var mes_ = mes+1;
  if (String(dia_).length == 1) dia_ = '0' + dia;
  if (String(mes_).length == 1){
    mes_ = '0' +String(mes+1);
  }
  var data_correta = dia_ + '/' + String(mes_) + '/' + ano;
  return String(data_correta);
}
function isToday(dia)
{
  return ( tv_day == dia && objCalendar.actualDate.getMonth() == tv_month && objCalendar.actualDate.getFullYear() == tv_year );
}

function verdata(){
    var texto, men=0;
    dias = $(".dias").children();
    for (var i=0; i<dias.length; i++){
        texto = $(".dias").children().eq(i).children().attr("data-data")
        texto=texto.split("/");     
        if (texto[0] != "undefined"){
            men=i;          
            break;
        }               
    }
    dt=[]
    j=0; 
    for (var i=men; i<dias.length; i++){
        dt[j] = $(".dias").children().eq(i).children().attr("data-data"); 
        j++;            
    }
    $.getJSON(BASEMETHOD + 'verData', {dt:dt}, function(data){
        if (data["ok"]){
            for (var i=0; i<=data["ok"].length; i++){
                if (data["ok"][i]){
                    var text = $(".dias").children().eq(men).children().text();
                    $(".dias").children().eq(men).children().children().remove();
                    $(".dias").children().eq(men).children().html(text);
                    $(".dias").children().eq(men).css("background","#F4C430");
                }
                men++;
            }

        }      
    }, "json");    
}

function reloadCalendar()
{
  var tbody = $('.dias');
  tbody.empty();
  createCalendar();
}
function newHref(dia, mes, ano)
{
  var dia_ = dia;
  if (String(dia_).length == 1) {
    dia_ = '0' + dia;
  }
  var url = tv_dates[ano + '-' + mes + '-' + dia_];
  if (url) return $('<a></a>').attr('href', url).text(dia);
  return dia;
}
function createCalendar()
{
  $('#nameMonth').text('Programas: ' + objCalendar.allMonth[ objCalendar.actualDate.getMonth() ] + ' de ' + objCalendar.actualDate.getFullYear());
  var tbody = $('.dias');
  var dayWeek = parseInt(firstDayWeek(objCalendar.actualDate));
  var daysMonth = getMonthDays(objCalendar.actualDate);
  var loopDay = 1;
  for (var i=6; i>0; --i) 
  {
      if (loopDay > daysMonth) break;
      
      for (var j=0; j < 7; ++j) 
      {
          var row = $('<li class="unit size1of7 bglo bcw"></li>');
          var cell = $('<div class="pvs tac bsols bcw" data-name='+String(objCalendar.actualDate.getMonth()+1)+' data-data='+String(format_data(dia,objCalendar.actualDate.getMonth(),objCalendar.actualDate.getFullYear()))+'></div>');
          cell.addClass('semana'+i);

          if (j >= dayWeek && isToday(loopDay))
            cell.addClass(objCalendar.actualDayClass);
          
          if((!((loopDay > 1 && loopDay <= daysMonth) || (dayWeek == j && loopDay == 1)))&&(loopDay >28))
          {
            return
          }
          if ((loopDay > 1 && loopDay <= daysMonth) || (dayWeek == j && loopDay == 1))
          {
             var dia = newHref(loopDay++, objCalendar.actualDate.getMonth()+1, objCalendar.actualDate.getFullYear());
             var data_correct = format_data(dia,objCalendar.actualDate.getMonth(),objCalendar.actualDate.getFullYear());
             $(cell).attr('data-data',String(format_data(dia,objCalendar.actualDate.getMonth(),objCalendar.actualDate.getFullYear())));
             cell.html('<a href="javascript:void(0);" onclick="link_dia(&quot;'+data_correct+'&quot;'+',&quot;semana'+i+'&quot;,this)">' + dia +'</a>' );
          } else { 
            cell.html('&nbsp;');
          }
          if(j == 0)
          {
            row.addClass('bgg');
            row.removeClass('bglo');
          }
          if(j == 6)
          {
            row.addClass('bgg');
            row.removeClass('bglo');
          }
          if((j>0)&&(j<6))
          {
            row.addClass('bglo');
            row.removeClass('bgg');
          }
          row.append(cell);
          tbody.append(row);
        }
    }
}
createCalendar();
verdata();


</script>

  <form name="conteudo" method="post" enctype="multipart/form-data">
    <fieldset>

      <div id="div_aba_geral">
        <div class="formu">
          <label for="titulo">T&iacute;tulo:&nbsp;(<span id="count_titulo">0</span>)</label>
          <spam style="display:block" class="titulo_spam" tal:content="n/titulo"></spam>
          <input disabled tal:attributes="value n/titulo" type="hidden" id="titulo" name="titulo" onkeyup="document.getElementById('count_titulo').innerHTML = this.value.length;" />
        </div>
        <div class="formu">
          <label for="titulo">Descri&ccedil;&atilde;o</label>
          <textarea id="descricao" name="descricao" class="full" tal:content="n/descricao"></textarea>
        </div>

        <div class="formu">
          <label for="data">Data</label>
          <spam class="data_spam" style="display:block" tal:content="n/data"></spam>
          <input disabled type="hidden" id="data" name="data" class="full" tal:attributes="value n/data" />
          <input type="hidden" name="id_conteudo" tal:attributes="value n/id_conteudo">
        </div>

        <div class="formu">&nbsp;</div>
        <div class="formu">
          <label for="campoPublicado">Publicado em:</label>
          <input type="text" name="publicado_em" format="##/##/#### ##:##" filter="0-9" tal:attributes="value n/publicado_em"/>
        </div>
        <div class="formu" nowrap>
          <label><input type="radio" name="publicado" value="P" tal:attributes="checked python:util.test(n['publicado'], 'checked', '')" />&nbsp;Publicado</label>
          <label><input type="radio" name="publicado" value="R" tal:attributes="checked python:util.test(n['publicado'], '', 'checked')" />&nbsp;Rascunho</label>
        </div>
        <div class="formu">&nbsp;</div>
      </div>

      <div id="div_aba_relacionamento" style="display:none">
        <tal:block tal:define="macro python:here.macros('/api/relacionamento.env');">
              <tal:block metal:use-macro="macro/macros/relacionamento"/>
        </tal:block>
      </div>


      <div id="div_aba_destaque" style="display:none">
        <tal:block tal:define="global conteudo n; macro python:here.macros('/api/destaque.env');">
              <tal:block metal:use-macro="macro/macros/destaque_edit"/>
        </tal:block>
      </div>

      <div class="formu" id="div_aba_tags" style="display:none">
        <div class="formu">
          <label>Tags</label>
          <textarea onchange="CHTAG = true" name="tags" class="full" style="height:150px" tal:content="python: portal._getTags(id_site=id_site, id_conteudo=id_conteudo, id_aplicativo=id_aplicativo)"></textarea>
        </div>
      </div>

      <tal:block tal:define="macro python:here.macros('/api/conteudo_permissao.env');">
            <tal:block metal:use-macro="macro/macros/edit"/>
      </tal:block>


    </fieldset>

    <div class="bts">
     <input id="bt_salvar" type="button" name="salvar" value="Salvar" class="f5bt ok" onclick="validaForm(false)" />
     <input id="bt_salvarp" type="button" name="salvarp" value="Salvar/Publicar" class="f5bt ok" onclick="validaForm(true)" tal:condition="publicacao/exportar" />
    </div>

  </form>
</slot_content>


</metal_macro>
</tal:block>
